syntax = "proto3";

import "swap.proto";

// Service Interface 
service Trade {  
  rpc Markets(MarketsRequest) returns (MarketsReply);
  rpc Balances(BalancesRequest) returns (BalancesReply);
  rpc TradePropose(TradeRequest) returns (stream TradeReply);
  rpc TradeComplete(TradeCompleteRequest) returns (stream TradeCompleteReply);
}

// Messages
message MarketsRequest {}
message MarketsReply {
  string base_asset = 1;
  repeated string quote_asset = 2;
}

message Balance {
  string asset = 1;
  int64 amount = 2;
}
message Market {
  string base_asset = 1;
  string quote_asset = 2;
}

message BalancesRequest {
  string quote_asset = 1;
}
message BalancesReply {
  repeated Balance balances = 1;
}

message TradeProposeRequest {
  string type = 1;
  Market market = 2;
  SwapRequest swap_request = 3;
}
message TradeProposeReply {
  SwapAccept msg = 1;
  SwapFail failure = 2;
}

message TradeCompleteRequest {}
message TradeCompleteReply {}
